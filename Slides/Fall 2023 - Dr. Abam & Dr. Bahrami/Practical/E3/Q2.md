+ محدودیت زمان: ۱ ثانیه
+ محدودیت حافظه: ۲۵۶ مگابایت

----------

بالاخره تعطیلات کریسمس فرا رسیده و جک می‌تواند چند روزی را با خانواده بگذراند.

جک می‌خواهد در روز کریسمس هم به خانه‌ی مادربزرگ مادری و هم به خانه‌ی پدربزرگ پدری اش سر بزند ولی از آنجا که مثل همیشه اولین برف زمستان در شب کریسمس باریده‌است، شهر در برف پوشیده شده است.

جک نمی‌تواند از معابری که پوشیده از برف هستند عبور کند. به همین‌خاطر برای رسیدن به خانه‌ی خویشانش نیاز دارد تا معابر را پارو کند. خبر خوب این که شهرداری آینده‌نگر برخی از بلوک‌های شهر را برف‌روبی کرده است.

پارو کردن بسیار طاقت‌فرساست. جک مدبر می‌خواهد قبل از آنکه دست به کار شود، روش بهینه برای پارو کردن را پیدا کند.

او نقشه هوایی شهر را در اختیار دارد. نقشه شهر به صورت یک جدول $n \times m$ است. که هر درایه جدول یک بلوک شهر را نشان می‌دهد. هر بلوک در یکی از ۳ حالت مسدود، پوشیده و روبیده قرار دارد.
جک بلوک خانه‌ی خود، پدربزرگ و مادربزرگ را در نقشه علامت زده است.

او در هر حرکت می‌تواند در یکی از چهار جهت اصلی به بلوک‌های مجاور ضلعی‌اش حرکت کند. اما نمی‌تواند وارد بلوک‌های مسدود شود و قبل از وارد شدن به بلوک‌های پوشیده باید آن‌ها را پارو کند.

جک باید تعدادی بلوک را پارو کند تا با شروع از خانه‌ی خود، هم بتواند به خانه‌ی پدربزرگ و هم بتواند به خانه‌ی مادربزرگ برود. دقت کنید که او نمی‌تواند برای رفتن به خانه‌ی کسی از خانه‌ی دیگری عبور کند.

جک می‌خواهد روشی که با پارو کردنِ کمترین تعداد بلوک او را به هدفش می‌رساند را بداند.

# ورودی

در خط اول ورودی دو عدد $n$ و $m$ آمده اند که به ترتیب تعداد سطر‌ها و تعداد ستون‌های نقشه اند.
$$ 1 \leq n, m \leq 505 $$
در $n$ خط بعدی در هر خط یک رشته به طول $m$ متشکل از کاراکتر های:
+ $\texttt{A}$ : خانه‌ی جک
+ $\texttt{B}$ : خانه‌ی مادربزرگ
+ $\texttt{C}$ : خانه‌ی پدربزرگ
+ $\texttt{\#}$ : بلوک مسدود
+ $\texttt{*}$ : بلوک پوشیده
+ $\texttt{.}$ : بلوک روبیده

تضمین می‌شود هر کدام از کاراکتر‌های $\texttt{A}$ , $\texttt{B}$ و $\texttt{C}$ دقیقا یک بار آمده است.

# خروجی

اگر جک نمی‌تواند به هدفش برسد در تنها خط خروجی عبارت `CHRISTMAS RUINED!` را چاپ کنید.

در غیر این صورت در خط اول خروجی کمترین تعداد بلوک که جک باید پارو کند را چاپ کنید.

و در  $n$ خط بعدی نقشه را چاپ کنید که در آن بلوک‌های پارو شده با کاراکتر $\texttt{o}$ نشان داده شده باشند.

در صورتی که بیش از یک روش بهینه برای پارو کردن وجود داشت، یکی را به دلخواه چاپ کنید.

# زیرمسئله‌ها

**در هر زیر‌مسئله در صورتی که تنها تعداد خانه‌های لازم را به درستی چاپ کنید، $60$ درصد نمره را دریافت می‌کنید.**

|        زیرمسئله  |  نمره	|   محدودیت       
|:------------------:|:----------:|:------------------:|
|       ۱   |   ۲۰         | خانه‌های $\texttt{A}$ و $\texttt{B}$ مجاور اند و در جدول کاراکتر $\texttt{.}$ نداریم.    |
|       ۲   |   ۳۰         |   خانه‌های $\texttt{A}$ و $\texttt{B}$ مجاور اند.     |
|       ۳   |   ۵۰         |       بدون محدودیت اضافی     |

# مثال
## ورودی نمونه ۱
```
7 6
......
*#.#**
.#.#.*
*..#*#
*AB#*#
.**#.C
.***.*
```


## خروجی نمونه ۱
```
3
......
*#.#o*
.#.#.*
*..#o#
*AB#o#
.**#.C
.***.*
```

## ورودی نمونه ۲
```
1 6
*AB**C
```


## خروجی نمونه ۲
```
CHRISTMAS RUINED!
```

## ورودی نمونه ۳
```
10 10
**********
*A**#***B*
**######**
**********
**##*####*
**#*******
***####***
****#*****
******C***
**********
```


## خروجی نمونه ۳
```
18
**********
*A**#***B*
*o######o*
*oooooooo*
**##o####*
**#*oooo**
***####o**
****#*oo**
******C***
**********
```

## ورودی نمونه ۴
```
18 15
#**..*##*#**##*
*A##.**#.*.#**#
**.#*****#*.###
.**#*##*#.**###
.#.*#**.#.*#*#B
*.##*#**#***...
.***##*#**.*.**
###**#**#****.*
.**.**#**##.**.
**.*#*##**#***#
***.*#*.#**#...
##**.#****..**#
#**.***.#*##***
.*****#.***##**
*..#.*#.#***.#*
#****#.**..****
*#**#*#*...*.*#
*.**.C*.##*....
```


## خروجی نمونه ۴
```
22
#**..*##*#**##*
oA##.**#.*.#**#
o*.#*****#*.###
.**#*##*#.**###
.#.*#**.#.*#*#B
o.##*#**#***...
.ooo##*#**.*.o*
###o*#**#****.*
.**.**#**##.*o.
**.o#*##**#**o#
***.*#*.#**#...
##*o.#*ooo..o*#
#**.ooo.#*##***
.*****#.***##**
*..#.*#.#***.#*
#****#.o*..****
*#**#*#o...*.*#
*.**.Co.##*....
```